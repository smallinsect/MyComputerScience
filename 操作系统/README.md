# 1 操作系统

学习视频

https://www.bilibili.com/video/BV1uW411f72n?p=2

## 1.1 操作系统概述

## 1.2 什么是操作系统？

- 什么是操作系统？

  - 用户角度上，操作系统是一个控制软件
  - 管理应用程序
  - 为应用程序提供服务
  - 杀死应用程序
  - 资源管理
  - 管理外设、分配资源
- 操作系统架层次结构
  - 硬件之上
  - 应用程序之下
- Linux、Windows、Android的界面属于外壳（Shell），而不是内核（kernel）。kernel使我们研究的重点，在shell之下。
- kernel-操作系统内部组件
  - CPU调度
  - 物理内存管理
  - 虚拟内存管理
  - 文件系统管理
  - 中断处理与设备驱动
- OS Kernel的特征
  - 并发
  - 计算机系统中同时存在多个运行的程序，需要OS管理和调度
  - 共享
    - “同时”访问
    - 互斥共享
  - 虚拟
    - 利用多道程序设计技术，让每个用户都觉得有一个计算机专门为他服务
  - 但只要运行环境相同，OS需要保证程序运行的结果也要相同

## 1.3 为什么学习操作系统？

- 综合课程-结合许多不同的课程
  - 程序设计语言
  - 数据结构
  - 算法
  - 计算机体系结构
  - 材料
  - 操作系统概念和原理，源代码
  - 技能
  - 操作系统的设计和实现

- 为什么要学习操作系统
  - 操作系统还在不停发展、在工控等各种领域有强烈需求
  - 操作系统很酷、很有用、有挑战

- 操作系统：计算机科学研究的基石之一
  - 计算机系统的基本组成部分
  - 又硬件的发展和应用需求所驱动
  - 学术和工业的持续推进

- 实际操作系统
  - Windows代码量巨大，不可能完全掌握
  - 目标是要理解其核心内容
- 操作系统管理并发
  - 并发导致有趣的编程挑战
- 操作系统代码管理原始硬件
  - 时间依赖行为，非法行为，硬件故障
- 操作系统代码必须是高效的低耗CPU、内存、磁盘的

- 操作系统出错，就意味着机器出错
  - 操作系统必须比用户程序拥有更高的稳定性

- 操作系统是系统安全的基础

- 操作系统需要权衡
  - 空间与时间
  - 性能和可预测性
  - 公平和性能

- 硬件方面，操作系统需要
  - 良好的硬件管理
  - 合理的资源分配
  - 例如：硬盘速度跟CPU、内存相差很多，操作系统需要协调处理

## 1.4 如何学习操作系统

- 动手
  - 操作系统课实验

- 我听到的我会忘记
- 我看到的我能记住
- 只有我做过的我才能理解

## 1.5 操作系统实例

## 1.7 操作系统结构

- 微内核的设计，尽可能把内核功能移到用户空间
- 学术界存在另一种更加极端的架构，“外核”

## 小结

- 课程概述
- 什么是操作系统？
- 为什么学习操作系统？
- 如何学习操作系统？
- 操作系统实例
- 操作系统的演变
- 操作系统结构

# 2 操作系统启动

- 启动
  - 计算机体系结构概述
  - 计算机内存和硬盘布局
  - 开机顺序
- 中断、异常和系统调用
  - 背景
  - 中断、异常和系统调用相比较
  - 中断和异常处理机制
  - 系统调用的概念
  - 系统调用的实现
  - 程序调用与系统调用的不同之处
  - 开销

DISK硬盘：存放OS操作系统

BIOS主板程序：基本I/O处理系统

Bootloader：加载OS

POST（加电自检）寻找显卡和执行BIOS

- 系统调用（来源于应用程序）
  - 应用程序主动向操作系统发出服务请求
- 异常（来源不良的应用程序）
  - 非法指令或者其他坏的处理状态（如：内存出错）
- 中断（来源于外设）
  - 来自不同的硬件设备的计时器和网络的中断
- 在计算机运行中，内核是被信任的第三方
- 只有内核可以执行特权指令
- 为了方便应用程序

- 操作系统如何设计和实现中断、异常和系统调用
- 他们三者有什么区别和特点
- 源头
  - 中断：外设
  - 异常：应用程序意想不到的行为
  - 系统调用：应用程序请求操作提供服务

- 处理时间
  - 中断：异步
  - 异常：同步
  - 系统调用：异步或同步
- 响应
  - 中断：持续，对用户应用程序是透明的
  - 异常：杀死或者重新执行意想不到的应用程序指令
  - 系统调用：等待和持续

## 2.2 操作系统的中断、异常和系统调用

硬件

- 设置中断标记[CPU初始化]
  - 将内部、外部事件设置中断标记
  - 中断事件的ID

软件

- 保存当前处理状态
- 中断服务程序处理
- 清楚中断标记
- 恢复之前保存的处理状态

异常

- 异常：异常编号
  - 保存现场
  - 异常处理
    - 杀死产生了异常的程序
    - 重新执行异常指令
  - 恢复现场

系统调用

- 程序访问主要是通过高层次的API接口而不是直接进行操作系统调用
- Win32 API 用于Windows
- POSIX API 用于POSIX-based systems（包括UNIX LINUX MacOS 的所有版本）
- Java API用于JAVA虚拟机（JVM）

# 3 计算机体系结构及内存分层体系

- 计算机体系结构/内存分层体系
- 地址空间 & 地址生成
- 连续内存分配

计算机体系结构/内存分层体系

	- 计算机体系结构
	- 内存分层体系
	- 在操作系统的内存管理范例